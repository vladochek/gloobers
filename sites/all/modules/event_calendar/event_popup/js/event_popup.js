!function(a){Drupal.behaviors.event_popup={attach:function(b,c){if(0==a("#event-popup-container").length){a("body").append('<div id="event-popup-container" style="display:none;"></div>');try{a("#event-popup-container").dialog({autoOpen:!1,modal:!0,close:function(b,c){a("#event-popup-container").html("")}});var d=Drupal.event_popup.explodeOptions(c.event_popup.defaults);a("#event-popup-container").dialog("option",d)}catch(a){Drupal.event_popup.log("[error] Event Dialog: "+a)}}var e="";c.event_popup.classes&&(e=", ."+c.event_popup.classes),a("a.event-popup"+e,b).each(function(b){b.metaKey||a(this).hasClass("simpleEventProcessed")||(a(this).addClass("simpleEventProcessed"),a(this).click(function(b){b.preventDefault();var d=a(this).attr("href"),e=a(this).attr("title"),f=a(this).attr("name")?a(this).attr("name"):c.event_popup.selector,g=Drupal.event_popup.explodeOptions("width:auto;height:auto;position:[300,140]");if(d&&e&&f)return a("#event-popup-container").dialog("option",g),a("#event-popup-container").dialog("option","title",e),a("#event-popup-container").html('<div class="event-popup-ajax-loader"></div>'),g.height&&"auto"==g.height&&a("#event-popup-container").dialog("option","height",200),a.get(d,function(b){g.height&&"auto"==g.height&&a("#event-popup-container").dialog("option","height",g.height),a("#event-popup-container").html(a("<div></div>").html(b).find("#"+f).clone())}),a("#event-popup-container").dialog("open"),!1}))});var f=Drupal.settings.event_popup.op;f&&a("table.full tr td, table.mini tr td",b).click(function(){var b=Drupal.settings.event_popup.content_type;b=b.replace("_","-");var c=Drupal.settings.basePath+"node/add/"+b,d="Create Event",e=Drupal.settings.event_popup.selector,f=Drupal.event_popup.explodeOptions("width:auto;height:auto;position:[300,140]");if(c&&d&&e){var g=a(this).attr("data-date");return a("#event-popup-container").dialog("option",f),a("#event-popup-container").dialog("option","title",d),a("#event-popup-container").html('<div class="event-popup-ajax-loader"></div>'),f.height&&"auto"==f.height&&a("#event-popup-container").dialog("option","height",200),a.get(c,{date:g},function(b){f.height&&"auto"==f.height&&a("#event-popup-container").dialog("option","height",f.height),a("#event-popup-container").html(a("<div></div>").html(b).find("#"+e).clone())}),a("#event-popup-container").dialog("open"),!1}})}},Drupal.event_popup={},Drupal.event_popup.explodeOptions=function(a){var b=a.split(";"),c={};for(var d in b)if(b[d]){var e=Drupal.event_popup.cleanOption(b[d].split(":"));c[e[0]]=e[1]}return c},Drupal.event_popup.cleanOption=function(a){return"position"==a[0]&&a[1].match(/\[.*,.*\]/)&&(a[1]=a[1].match(/\[(.*)\]/)[1].split(","),isNaN(parseInt(a[1][0]))||(a[1][0]=parseInt(a[1][0])),isNaN(parseInt(a[1][1]))||(a[1][1]=parseInt(a[1][1]))),"true"===a[1]?a[1]=!0:"false"===a[1]&&(a[1]=!1),a},Drupal.event_popup.log=function(a){window.console&&window.console.log(a)}}(jQuery);